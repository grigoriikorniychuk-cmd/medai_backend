# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ API –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ AI + –ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ MedAI –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ –º–µ—Ç–æ–¥–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –ø—Ä–∏–Ω—è–≤—à–µ–≥–æ –∑–≤–æ–Ω–æ–∫:

1. **amoCRM** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ AmoCRM
2. **ai_schedule** (–Ω–æ–≤—ã–π) - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ AI –∞–Ω–∞–ª–∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ + –≥—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã

## –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –≠–Ω–¥–ø–æ–∏–Ω—Ç
```
PATCH /api/clinics/{clinic_id}/settings
```

### –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞
```json
{
  "admin_detection_method": "ai_schedule"
}
```

**–î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:**
- `"amocrm"` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AmoCRM (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `"ai_schedule"` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AI + –≥—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–∏–º–µ—Ä curl
```bash
curl -X PATCH 'https://api.mlab-electronics.ru/api/clinics/be735efe-2f45-4262-9df1-289db57a71b5/settings' \
  -H 'Content-Type: application/json' \
  -d '{"admin_detection_method": "ai_schedule"}'
```

### –û—Ç–≤–µ—Ç
```json
{
  "success": true,
  "message": "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∏–Ω–∏–∫–∏ be735efe-2f45-4262-9df1-289db57a71b5 –æ–±–Ω–æ–≤–ª–µ–Ω—ã",
  "updated_settings": {
    "admin_detection_method": "ai_schedule"
  }
}
```

---

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ —Ä–∞–±–æ—Ç—ã

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≥—Ä–∞—Ñ–∏–∫–∞

#### –≠–Ω–¥–ø–æ–∏–Ω—Ç
```
POST /api/work-schedules
```

#### –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞
```json
{
  "clinic_id": "be735efe-2f45-4262-9df1-289db57a71b5",
  "administrator_id": "6756789abcdef123456789ab",
  "dates": ["2025-12-26", "2025-12-27", "2025-12-28"],
  "first_name": "–ê–Ω–Ω–∞",
  "last_name": "–ò–≤–∞–Ω–æ–≤–∞"
}
```

**–ü–æ–ª—è:**
- `clinic_id` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - UUID –∫–ª–∏–Ω–∏–∫–∏
- `administrator_id` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - ObjectId –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `administrators`
- `dates` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –º–∞—Å—Å–∏–≤ –¥–∞—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM-DD`
- `first_name` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –∏–º—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `last_name` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - —Ñ–∞–º–∏–ª–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –î–ª—è –∫–∞–∂–¥–æ–π –¥–∞—Ç—ã —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å—å
- –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ–Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–∞—Ç —Å—Ä–∞–∑—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ –Ω–µ–¥–µ–ª—é –∏–ª–∏ –º–µ—Å—è—Ü –≤–ø–µ—Ä—ë–¥)

#### –ü—Ä–∏–º–µ—Ä curl
```bash
curl -X POST 'https://api.mlab-electronics.ru/api/work-schedules' \
  -H 'Content-Type: application/json' \
  -d '{
    "clinic_id": "be735efe-2f45-4262-9df1-289db57a71b5",
    "administrator_id": "6756789abcdef123456789ab",
    "dates": ["2025-12-26", "2025-12-27", "2025-12-28", "2025-12-29", "2025-12-30"],
    "first_name": "–ê–Ω–Ω–∞",
    "last_name": "–ò–≤–∞–Ω–æ–≤–∞"
  }'
```

#### –û—Ç–≤–µ—Ç
```json
{
  "message": "–°–æ–∑–¥–∞–Ω–æ 5 –∑–∞–ø–∏—Å–µ–π –≥—Ä–∞—Ñ–∏–∫–∞",
  "created_ids": [
    "67895abc12def34567890123",
    "67895abc12def34567890124",
    "67895abc12def34567890125",
    "67895abc12def34567890126",
    "67895abc12def34567890127"
  ]
}
```

---

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤

#### –≠–Ω–¥–ø–æ–∏–Ω—Ç
```
GET /api/work-schedules?clinic_id={clinic_id}&date_from={date_from}&date_to={date_to}
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
- `clinic_id` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - UUID –∫–ª–∏–Ω–∏–∫–∏
- `date_from` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –Ω–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM-DD`
- `date_to` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∫–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM-DD`

#### –ü—Ä–∏–º–µ—Ä curl
```bash
# –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∫–ª–∏–Ω–∏–∫–∏
curl 'https://api.mlab-electronics.ru/api/work-schedules?clinic_id=be735efe-2f45-4262-9df1-289db57a71b5'

# –ü–æ–ª—É—á–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥
curl 'https://api.mlab-electronics.ru/api/work-schedules?clinic_id=be735efe-2f45-4262-9df1-289db57a71b5&date_from=2025-12-26&date_to=2025-12-31'
```

#### –û—Ç–≤–µ—Ç
```json
{
  "count": 5,
  "schedules": [
    {
      "_id": "67895abc12def34567890123",
      "clinic_id": "be735efe-2f45-4262-9df1-289db57a71b5",
      "administrator_id": "6756789abcdef123456789ab",
      "date": "2025-12-26",
      "first_name": "–ê–Ω–Ω–∞",
      "last_name": "–ò–≤–∞–Ω–æ–≤–∞",
      "created_at": "2025-12-25T10:30:00Z"
    },
    {
      "_id": "67895abc12def34567890124",
      "clinic_id": "be735efe-2f45-4262-9df1-289db57a71b5",
      "administrator_id": "6756789abcdef123456789ab",
      "date": "2025-12-27",
      "first_name": "–ê–Ω–Ω–∞",
      "last_name": "–ò–≤–∞–Ω–æ–≤–∞",
      "created_at": "2025-12-25T10:30:00Z"
    }
  ]
}
```

---

### 3. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≥—Ä–∞—Ñ–∏–∫–∞

#### –≠–Ω–¥–ø–æ–∏–Ω—Ç
```
PUT /api/work-schedules/{schedule_id}
```

#### –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞
```json
{
  "first_name": "–ú–∞—Ä–∏—è",
  "last_name": "–ü–µ—Ç—Ä–æ–≤–∞"
}
```

**–ü–æ–ª—è (–≤—Å–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ):**
- `first_name` - –Ω–æ–≤–æ–µ –∏–º—è
- `last_name` - –Ω–æ–≤–∞—è —Ñ–∞–º–∏–ª–∏—è
- `date` - –Ω–æ–≤–∞—è –¥–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM-DD`

#### –ü—Ä–∏–º–µ—Ä curl
```bash
curl -X PUT 'https://api.mlab-electronics.ru/api/work-schedules/67895abc12def34567890123' \
  -H 'Content-Type: application/json' \
  -d '{
    "first_name": "–ú–∞—Ä–∏—è",
    "last_name": "–ü–µ—Ç—Ä–æ–≤–∞"
  }'
```

#### –û—Ç–≤–µ—Ç
```json
{
  "message": "–ì—Ä–∞—Ñ–∏–∫ 67895abc12def34567890123 —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª—ë–Ω",
  "updated_fields": ["first_name", "last_name"]
}
```

---

### 4. –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≥—Ä–∞—Ñ–∏–∫–∞

#### –≠–Ω–¥–ø–æ–∏–Ω—Ç
```
DELETE /api/work-schedules/{schedule_id}
```

#### –ü—Ä–∏–º–µ—Ä curl
```bash
curl -X DELETE 'https://api.mlab-electronics.ru/api/work-schedules/67895abc12def34567890123'
```

#### –û—Ç–≤–µ—Ç
```json
{
  "message": "–ì—Ä–∞—Ñ–∏–∫ 67895abc12def34567890123 —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª—ë–Ω"
}
```

---

## UI Flow (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞)

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∏–Ω–∏–∫–∏ - –≤—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞

**–°—Ç—Ä–∞–Ω–∏—Ü–∞:** –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∏–Ω–∏–∫–∏  
**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å (radio buttons –∏–ª–∏ toggle)

```
‚ñ° –û–ø—Ä–µ–¥–µ–ª—è—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ AmoCRM (–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
‚óã –û–ø—Ä–µ–¥–µ–ª—è—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ AI + –≥—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã
```

**–õ–æ–≥–∏–∫–∞:**
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ "AI + –≥—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã" –ø–æ–∫–∞–∑–∞—Ç—å warning:
  > ‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ!** –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤. –ù–µ–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–Ω–∏ –±—É–¥—É—Ç –ø–æ–¥—Å–≤–µ—á–µ–Ω—ã –∫—Ä–∞—Å–Ω—ã–º.

- –ü—Ä–∏ –∫–ª–∏–∫–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –æ—Ç–ø—Ä–∞–≤–∏—Ç—å PATCH –∑–∞–ø—Ä–æ—Å –Ω–∞ `/api/clinics/{clinic_id}/settings`

### 2. –°—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–º

**–ù–∞–≤–∏–≥–∞—Ü–∏—è:** –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

#### 2.1. –§–∏–ª—å—Ç—Ä—ã
```
–ú–µ—Å—è—Ü: [–¥–µ–∫–∞–±—Ä—å 2025 ‚ñº]   [‚Üê –ù–∞–∑–∞–¥] [–í–ø–µ—Ä—ë–¥ ‚Üí]
```

#### 2.2. –¢–∞–±–ª–∏—Ü–∞ –≥—Ä–∞—Ñ–∏–∫–∞
```
+------------+----------------+------------------+----------+
| –î–∞—Ç–∞       | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä  | –ò–º—è              | –î–µ–π—Å—Ç–≤–∏—è |
+------------+----------------+------------------+----------+
| 2025-12-26 | –ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞   | –ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞     | [‚úèÔ∏è] [üóëÔ∏è]  |
| 2025-12-27 | –ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞  | –ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞    | [‚úèÔ∏è] [üóëÔ∏è]  |
| 2025-12-28 | ‚ö†Ô∏è –ù–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ |                 | [‚ûï]      |
| 2025-12-29 | –ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞   | –ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞     | [‚úèÔ∏è] [üóëÔ∏è]  |
+------------+----------------+------------------+----------+
```

**–¶–≤–µ—Ç–∞:**
- ‚úÖ –ó–µ–ª—ë–Ω—ã–π —Ñ–æ–Ω - –¥–Ω–∏ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –≥—Ä–∞—Ñ–∏–∫–æ–º
- üî¥ –ö—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω - –¥–Ω–∏ –±–µ–∑ –≥—Ä–∞—Ñ–∏–∫–∞ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω —Ä–µ–∂–∏–º "ai_schedule")
- ‚ö™ –û–±—ã—á–Ω—ã–π —Ñ–æ–Ω - –¥–Ω–∏ –±–µ–∑ –≥—Ä–∞—Ñ–∏–∫–∞ (–µ—Å–ª–∏ —Ä–µ–∂–∏–º "amocrm")

#### 2.3. –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å":**

```
–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä: [–í—ã–±—Ä–∞—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞ ‚ñº]
               ‚Üì
               –ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞ (ID: 6756789abcdef123456789ab)
               –ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞ (ID: 6756789abcdef123456789bc)

–î–∞—Ç—ã:          [26.12.2025] [–í—ã–±—Ä–∞—Ç—å –¥–∞—Ç—ã...]

               ‚òë 26.12  ‚òë 27.12  ‚òê 28.12  ‚òë 29.12  ‚òë 30.12

               [–û—Ç–º–µ–Ω–∞]  [–°–æ—Ö—Ä–∞–Ω–∏—Ç—å]
```

**–õ–æ–≥–∏–∫–∞:**
1. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –∫–ª–∏–Ω–∏–∫–∏ –∏–∑ `/api/admin/clinics/{client_id}` –∏–ª–∏ `/api/administrators?clinic_id=...`
2. –ü–æ–∑–≤–æ–ª–∏—Ç—å –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–∞—Ç —á–µ—Ä–µ–∑ date picker
3. –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å POST –∑–∞–ø—Ä–æ—Å –Ω–∞ `/api/work-schedules` —Å –º–∞—Å—Å–∏–≤–æ–º –¥–∞—Ç

**–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å—å":**

```
–î–∞—Ç–∞:          26.12.2025 (–Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, —Ç–æ–ª—å–∫–æ –∏–º—è/–¥–∞—Ç—É)

–ò–º—è:           [–ê–Ω–Ω–∞________]
–§–∞–º–∏–ª–∏—è:       [–ò–≤–∞–Ω–æ–≤–∞_____]

               [–û—Ç–º–µ–Ω–∞]  [–°–æ—Ö—Ä–∞–Ω–∏—Ç—å]
```

#### 2.4. –í–∞–ª–∏–¥–∞—Ü–∏—è

**–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—ã–±—Ä–∞–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—ã–±—Ä–∞–Ω–∞ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –¥–∞—Ç–∞
- –ü—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å –µ—Å–ª–∏ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞—Ç —É–∂–µ –µ—Å—Ç—å –∑–∞–ø–∏—Å–∏

**–ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—è –Ω–µ –ø—É—Å—Ç—ã–µ

**–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏:**
- –ü–æ–∫–∞–∑–∞—Ç—å confirm dialog:
  > –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –≥—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è **–ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞** –Ω–∞ **26.12.2025**?

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### Collection: `work_schedules`

```json
{
  "_id": ObjectId("67895abc12def34567890123"),
  "clinic_id": "be735efe-2f45-4262-9df1-289db57a71b5",
  "administrator_id": ObjectId("6756789abcdef123456789ab"),
  "date": ISODate("2025-12-26T00:00:00.000Z"),
  "first_name": "–ê–Ω–Ω–∞",
  "last_name": "–ò–≤–∞–Ω–æ–≤–∞",
  "created_at": ISODate("2025-12-25T10:30:00.000Z"),
  "updated_at": ISODate("2025-12-25T12:15:00.000Z")  // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
}
```

**–ò–Ω–¥–µ–∫—Å—ã:**
- `{clinic_id: 1, date: 1}` - –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –ø–æ –∫–ª–∏–Ω–∏–∫–µ –∏ –¥–∞—Ç–µ

### Collection: `clinics` (–Ω–æ–≤–æ–µ –ø–æ–ª–µ)

```json
{
  "_id": "be735efe-2f45-4262-9df1-289db57a71b5",
  "name": "–°—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—è –ë–µ–ª–ª–∞–º—É—Å",
  "admin_detection_method": "ai_schedule",  // "amocrm" –∏–ª–∏ "ai_schedule"
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
}
```

---

## –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–±—ç–∫–µ–Ω–¥)

### –†–µ–∂–∏–º "amocrm"
1. –ü–æ–ª—É—á–∏—Ç—å `responsible_user_id` –∏–∑ AmoCRM
2. –ù–∞–π—Ç–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ `amocrm_user_id` –≤ collection `administrators`
3. –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∫–ª–∏–Ω–∏–∫–∏

### –†–µ–∂–∏–º "ai_schedule"
1. –ü–æ–ª—É—á–∏—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é –∑–≤–æ–Ω–∫–∞
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AI –ø—Ä–æ–º–ø—Ç –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–º–µ–Ω–∏ –∏ —Ñ–∞–º–∏–ª–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
3. –ü–æ–ª—É—á–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –Ω–∞ –¥–∞—Ç—É –∑–≤–æ–Ω–∫–∞
4. **–ï—Å–ª–∏ 1 –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤ –≥—Ä–∞—Ñ–∏–∫–µ** ‚Üí –≤–µ—Ä–Ω—É—Ç—å –µ–≥–æ ID
5. **–ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:**
   - Fuzzy matching (–ø–æ—Ä–æ–≥ 80%) –∏–∑–≤–ª–µ—á—ë–Ω–Ω–æ–≥–æ –∏–º–µ–Ω–∏ —Å –∏–º–µ–Ω–∞–º–∏ –∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ ‚Üí –≤–µ—Ä–Ω—É—Ç—å ID
   - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö ‚Üí **fallback –∫ amoCRM**
6. **–ï—Å–ª–∏ –≥—Ä–∞—Ñ–∏–∫ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω –Ω–∞ –¥–∞—Ç—É –∑–≤–æ–Ω–∫–∞** ‚Üí **fallback –∫ amoCRM**

---

## –ö–æ–¥—ã –æ—à–∏–±–æ–∫

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ                                    |
|-----|---------------------------------------------|
| 400 | –ù–µ–≤–µ—Ä–Ω—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–≤–∞–ª–∏–¥–∞—Ü–∏—è)        |
| 404 | –ö–ª–∏–Ω–∏–∫–∞/–≥—Ä–∞—Ñ–∏–∫/–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω—ã    |
| 500 | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞                  |

---

## –ü—Ä–∏–º–µ—Ä—ã —Ç–∏–ø–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–ª–∏–Ω–∏–∫–∏ –Ω–∞ AI + –≥—Ä–∞—Ñ–∏–∫

```bash
# 1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –º–µ—Ç–æ–¥
curl -X PATCH 'https://api.mlab-electronics.ru/api/clinics/be735efe-2f45-4262-9df1-289db57a71b5/settings' \
  -H 'Content-Type: application/json' \
  -d '{"admin_detection_method": "ai_schedule"}'

# 2. –°–æ–∑–¥–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ –Ω–∞ –Ω–µ–¥–µ–ª—é –¥–ª—è –ê–Ω–Ω—ã –ò–≤–∞–Ω–æ–≤–æ–π
curl -X POST 'https://api.mlab-electronics.ru/api/work-schedules' \
  -H 'Content-Type: application/json' \
  -d '{
    "clinic_id": "be735efe-2f45-4262-9df1-289db57a71b5",
    "administrator_id": "6756789abcdef123456789ab",
    "dates": ["2025-12-26", "2025-12-27", "2025-12-28"],
    "first_name": "–ê–Ω–Ω–∞",
    "last_name": "–ò–≤–∞–Ω–æ–≤–∞"
  }'

# 3. –°–æ–∑–¥–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ –Ω–∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–Ω–∏ –¥–ª—è –ú–∞—Ä–∏–∏ –ü–µ—Ç—Ä–æ–≤–æ–π
curl -X POST 'https://api.mlab-electronics.ru/api/work-schedules' \
  -H 'Content-Type: application/json' \
  -d '{
    "clinic_id": "be735efe-2f45-4262-9df1-289db57a71b5",
    "administrator_id": "6756789abcdef123456789bc",
    "dates": ["2025-12-29", "2025-12-30", "2025-12-31"],
    "first_name": "–ú–∞—Ä–∏—è",
    "last_name": "–ü–µ—Ç—Ä–æ–≤–∞"
  }'
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –≤ –≥—Ä–∞—Ñ–∏–∫–µ

```bash
# 1. –ü–æ–ª—É—á–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –∑–∞ –¥–µ–∫–∞–±—Ä—å
curl 'https://api.mlab-electronics.ru/api/work-schedules?clinic_id=be735efe-2f45-4262-9df1-289db57a71b5&date_from=2025-12-01&date_to=2025-12-31'

# 2. –ù–∞–π—Ç–∏ –∑–∞–ø–∏—Å—å —Å –æ—à–∏–±–∫–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è)
# 3. –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å
curl -X PUT 'https://api.mlab-electronics.ru/api/work-schedules/67895abc12def34567890123' \
  -H 'Content-Type: application/json' \
  -d '{
    "first_name": "–ê–Ω–Ω–∞",
    "last_name": "–°–º–∏—Ä–Ω–æ–≤–∞"
  }'
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –í–æ–∑–≤—Ä–∞—Ç –∫ —Ä–µ–∂–∏–º—É AmoCRM

```bash
curl -X PATCH 'https://api.mlab-electronics.ru/api/clinics/be735efe-2f45-4262-9df1-289db57a71b5/settings' \
  -H 'Content-Type: application/json' \
  -d '{"admin_detection_method": "amocrm"}'
```

---

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é** —á–µ—Ä–µ–∑ UI —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∏–ª–∏ API
2. **–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ** –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
3. **–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fuzzy matching** –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏–º—ë–Ω (–ø–æ—Ä–æ–≥ 80%)
4. **–ü—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∏–º–µ–Ω–∞ –≤ –æ–¥–∏–Ω –¥–µ–Ω—å) —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback –∫ AmoCRM**
5. **–ù–µ–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–Ω–∏ –≤ –≥—Ä–∞—Ñ–∏–∫–µ** –ø—Ä–∏ —Ä–µ–∂–∏–º–µ "ai_schedule" –¥–æ–ª–∂–Ω—ã –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—Ç—å—Å—è –∫—Ä–∞—Å–Ω—ã–º –≤ UI
6. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥** - –ø—Ä–æ—Å—Ç–æ —É–∫–∞–∑–∞—Ç—å –≤—Å–µ –Ω—É–∂–Ω—ã–µ –¥–∞—Ç—ã –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
7. **–î–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –Ω–∞ –º–µ—Å—è—Ü** –≤ –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç `POST /api/work-schedules/batch`
