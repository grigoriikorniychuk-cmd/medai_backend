Резюме изменений:
Что было исправлено:
Правильный подсчёт кредитов - теперь считаем по duration аудио (27.78 кредитов/минуту), а не по символам текста

Блокировка при превышении лимита - добавлена проверка в transcribe_and_save():

Проверяется лимит ПЕРЕД транскрипцией
При превышении: статус звонка limit_exceeded, транскрипция НЕ выполняется
Exception с детальным сообщением
Синхронизация с ElevenLabs API - новые функции:

get_elevenlabs_usage() - получает реальный баланс из ElevenLabs
sync_with_elevenlabs() - синхронизирует и сохраняет в базу
Новые endpoints в /api/admin/:

GET /elevenlabs/usage - текущий баланс ElevenLabs
POST /elevenlabs/sync - синхронизация с ElevenLabs
GET /clinics/{client_id}/limits - лимиты клиники
POST /clinics/{client_id}/limits/reset - сброс счётчика на 0
PUT /clinics/{client_id}/limits - установить лимиты
Рекомендации:
Установите правильный monthly_limit для клиники:

PRO план даёт 300 часов = 500,000 кредитов на месяц
Если 6 клиник: ~83,000 кредитов на клинику
Сбросьте current_month_usage на 0 через endpoint или MongoDB

Периодическая синхронизация - вызывайте /api/admin/elevenlabs/sync раз в день чтобы видеть реальный баланс ElevenLabs

Хотите закоммитить и запушить эти изменения?